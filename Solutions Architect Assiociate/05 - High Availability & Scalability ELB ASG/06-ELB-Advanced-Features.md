---
title: ELB Advanced Features
date: 2026-02-09
tags:
  - aws
  - elb
  - sticky-sessions
  - cross-zone
  - ssl
  - sni
  - connection-draining
  - saa-c03
---

# ELB Advanced Features

## 1. Sticky Sessions (Session Affinity)

A client is always redirected to the ==same backend instance== using cookies.

| Feature | Details |
|---------|---------|
| **Supported** | CLB, ALB, NLB |
| **Mechanism** | ==Cookie== with expiration date |
| **Use case** | Preserve user session data (login) |
| **Risk** | ==Load imbalance== if some users are very sticky |
| **Duration range** | ==1 second to 7 days== |
| **Configure at** | ==Target group level== (Actions → Edit attributes) |

### Cookie Types

| Type | Generated By | Cookie Name |
|------|-------------|-------------|
| **Duration-based** | Load balancer | `AWSALB` (ALB), `AWSELB` (CLB) |
| **Application-based** (LB) | Load balancer | `AWSALBAPP` |
| **Application-based** (Custom) | Your application | Custom name (not AWSALB*) |

> [!warning] Reserved Names
> Do not use `AWSALB`, `AWSALBAPP`, or `AWSALBTG` as custom cookie names — they're reserved by ELB.

## 2. Cross-Zone Load Balancing

| Setting | With Cross-Zone | Without Cross-Zone |
|---------|----------------|-------------------|
| **Traffic** | Distributed ==evenly across all instances in all AZs== | Stays ==within each AZ== |
| **Imbalance risk** | Low | High (if uneven instances per AZ) |

```
WITH Cross-Zone (10 instances total):
AZ1 (2 instances): each gets 10% of total traffic
AZ2 (8 instances): each gets 10% of total traffic

WITHOUT Cross-Zone:
AZ1 (2 instances): each gets 25% of total traffic ← overloaded!
AZ2 (8 instances): each gets 6.25% of total traffic
```

### Defaults & Charges

| LB Type | Default | Inter-AZ Data Charges |
|---------|---------|----------------------|
| **ALB** | ==On== | ==No charge== |
| **NLB** | ==Off== | ==Charged== if enabled |
| **GWLB** | ==Off== | ==Charged== if enabled |

> [!note] ALB Target Group Override
> ALB cross-zone is always on at the LB level, but can be overridden ==per target group==: inherit (default), force on, or ==force off==.

## 3. SSL/TLS Certificates

SSL encrypts traffic ==in transit== between client and load balancer.

| Feature | Details |
|---------|---------|
| **SSL** | Secure Sockets Layer (older) |
| **TLS** | Transport Layer Security (newer, actually used) |
| **Certificate** | X.509, managed via ==ACM== (AWS Certificate Manager) |
| **Termination** | LB decrypts HTTPS → sends HTTP to EC2 over VPC |
| **Import** | Can upload own certs (private key + body + chain) to ACM |
| **Security Policy** | Configurable for older SSL/TLS version support (legacy clients) |

### SNI (Server Name Indication)

Allows ==multiple SSL certificates on one load balancer== for different domains.

| LB Type | Multiple SSL Certs? | SNI? |
|---------|-------------------|------|
| **CLB** | ==No== (1 cert, need multiple CLBs) | ❌ |
| **ALB** | ==Yes== (multiple listeners) | ✅ |
| **NLB** | ==Yes== (multiple listeners) | ✅ |

> [!tip] Exam Tip
> Multiple SSL certificates on one LB → ==ALB or NLB with SNI==. CLB needs one LB per cert.

```
Client says: "I want www.mycorp.com"  (SNI)
    │
    ▼
┌─────────┐
│   ALB   │──▶ Uses mycorp.com SSL cert → Target Group 1
│         │
│         │──▶ Uses domain1.com SSL cert → Target Group 2
└─────────┘
```

## 4. Connection Draining / Deregistration Delay

Gives in-flight requests time to complete when an instance is being removed.

| Feature | Details |
|---------|---------|
| **CLB name** | Connection Draining |
| **ALB/NLB name** | ==Deregistration Delay== |
| **Default** | ==300 seconds== (5 min) |
| **Range** | 1 – 3,600 seconds (0 = disabled) |
| **Behavior** | Existing connections finish; new connections go elsewhere |

> [!note] Best Practice
> Short requests → low draining time (30s). Long requests/uploads → higher draining time.

## Questions & Answers

> [!question]- Q1: What are sticky sessions?
> **Answer:**
> A feature that ensures a client is always routed to the ==same backend instance== using cookies. Used to preserve session data like login state.

> [!question]- Q2: What is cross-zone load balancing?
> **Answer:**
> Traffic is distributed ==evenly across all instances in all AZs==, regardless of which AZ the LB node received the request. Without it, traffic stays within each AZ.

> [!question]- Q3: Is cross-zone load balancing enabled by default on ALB?
> **Answer:**
> ==Yes==, and there are ==no inter-AZ data charges==. For NLB and GWLB, it's ==off by default== and you ==pay for inter-AZ data== if enabled.

> [!question]- Q4: What is SNI?
> **Answer:**
> ==Server Name Indication== — allows loading ==multiple SSL certificates on one load balancer==. The client specifies the hostname during the SSL handshake, and the LB selects the correct certificate. Works on ==ALB and NLB only==.

> [!question]- Q5: How many SSL certificates can a CLB have?
> **Answer:**
> ==Only one==. For multiple domains with different SSL certs, you need ==multiple CLBs==. Use ALB or NLB with SNI instead.

> [!question]- Q6: What is connection draining?
> **Answer:**
> Time given to ==complete in-flight requests== when an instance is being deregistered or marked unhealthy. New requests go to other instances. Default ==300 seconds==.

> [!question]- Q7: Where are SSL certificates managed in AWS?
> **Answer:**
> ==AWS Certificate Manager (ACM)==. You can also upload your own certificates. The LB uses X.509 certificates for HTTPS termination.

> [!question]- Q8: What happens to new requests during connection draining?
> **Answer:**
> New requests are ==routed to other healthy instances==. Only existing in-flight connections continue to the draining instance until they complete or the timeout expires.

> [!question]- Q9: What is the risk of enabling sticky sessions?
> **Answer:**
> ==Load imbalance==. If some users generate heavy traffic and are "stuck" to one instance, that instance gets overloaded while others are underutilized.

> [!question]- Q10: What is the difference between duration-based and application-based cookies?
> **Answer:**
> - **Duration-based**: Generated by ==LB==, expiry set by LB (cookie: `AWSALB`)
> - **Application-based**: Generated by ==your app== or LB, expiry set by app (custom cookie name or `AWSALBAPP`)
